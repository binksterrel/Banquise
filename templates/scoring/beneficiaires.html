{% extends 'base.html' %}

{% block title %}Mes Bénéficiaires - Banquise{% endblock %}

{% block extra_css %}
<style>
    /* Réutilisation des styles spécifiques si nécessaire, 
       mais la plupart sont gérés par Tailwind et votre classe glass-premium */
</style>
{% endblock %}

{% block content %}
<div class="relative min-h-screen overflow-hidden">
    <div class="absolute top-0 left-0 w-full h-full z-0 pointer-events-none">
        <div class="absolute top-20 right-20 w-96 h-96 bg-ice-200 rounded-full blur-3xl opacity-50"></div>
        <div class="absolute bottom-0 left-10 w-72 h-72 bg-purple-100 rounded-full blur-3xl opacity-40"></div>
    </div>

    <div class="relative z-10 max-w-5xl mx-auto py-12 px-4">

        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-4">
            <div>
                <h1 class="text-4xl font-display font-bold text-slate-900">Mes Bénéficiaires</h1>
                <p class="text-slate-500 text-lg mt-2">Gérez vos contacts favoris pour des virements plus rapides.</p>
            </div>
            <a href="{% url 'ajouter_beneficiaire' %}"
                class="px-6 py-3 bg-slate-900 text-white font-bold rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 flex items-center gap-2">
                <i class="bi bi-person-plus-fill"></i>
                <span>Nouveau Bénéficiaire</span>
            </a>
        </div>

        {% if messages %}
        <div class="mb-6 space-y-2">
            {% for message in messages %}
            <div
                class="p-4 rounded-xl flex items-center gap-3 {% if message.tags == 'success' %}bg-green-100 text-green-800 border border-green-200{% elif message.tags == 'error' %}bg-red-100 text-red-800 border border-red-200{% else %}bg-blue-100 text-blue-800{% endif %}">
                <i
                    class="bi {% if message.tags == 'success' %}bi-check-circle-fill{% else %}bi-info-circle-fill{% endif %}"></i>
                <span class="font-medium">{{ message }}</span>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <div class="glass-premium p-1 rounded-[2rem] overflow-hidden shadow-xl">
            {% if beneficiaires %}
            <div class="grid gap-2 p-4 md:p-6">
                {% for bene in beneficiaires %}
                <div
                    class="group p-4 bg-white/60 hover:bg-white rounded-2xl border border-slate-100 hover:border-ice-300 transition-all duration-200 flex flex-col md:flex-row justify-between items-center gap-4">

                    <div class="flex items-center gap-4 w-full md:w-auto">
                        <div
                            class="w-12 h-12 flex-shrink-0 rounded-full bg-gradient-to-br from-ice-100 to-white border border-ice-200 flex items-center justify-center text-ice-600 font-bold text-lg shadow-sm">
                            {{ bene.surnom|default:bene.nom|slice:":2"|upper }}
                        </div>

                        <div>
                            <h3 class="font-bold text-slate-900 text-lg">{{ bene.surnom|default:bene.nom }}</h3>
                            <p class="text-xs text-slate-500">Nom officiel : {{ bene.nom }}</p>
                            <div class="flex items-center gap-2 text-slate-500 text-sm font-mono">
                                <i class="bi bi-credit-card"></i> {{ bene.iban }}
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center gap-3 w-full md:w-auto justify-end">
                        <a href="{% url 'virement' %}?beneficiaire={{ bene.id }}"
                            class="px-4 py-2 rounded-lg bg-ice-50 text-ice-700 font-bold text-sm hover:bg-ice-100 border border-ice-100 transition-colors">
                            <i class="bi bi-send"></i> Virer
                        </a>

                        <a href="{% url 'modifier_beneficiaire' bene.id %}"
                            class="w-10 h-10 rounded-lg flex items-center justify-center text-slate-400 hover:text-ice-600 hover:bg-ice-50 border border-transparent hover:border-ice-100 transition-all"
                            title="Modifier">
                            <i class="bi bi-pencil"></i>
                        </a>

                        <a href="{% url 'supprimer_beneficiaire' bene.id %}"
                            class="w-10 h-10 rounded-lg flex items-center justify-center text-slate-400 hover:text-red-500 hover:bg-red-50 border border-transparent hover:border-red-100 transition-all"
                            title="Supprimer">
                            <i class="bi bi-trash"></i>
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="flex flex-col items-center justify-center py-16 text-center">
                <div
                    class="w-20 h-20 rounded-full bg-slate-100 flex items-center justify-center text-slate-300 mb-4 text-3xl">
                    <i class="bi bi-people"></i>
                </div>
                <h3 class="text-xl font-bold text-slate-700">Aucun bénéficiaire</h3>
                <p class="text-slate-400 mt-2 max-w-sm">Ajoutez des comptes favoris pour effectuer vos virements en
                    quelques clics.</p>
            </div>
            {% endif %}
        </div>

        <div class="mt-8 flex gap-4">
            <a href="{% url 'dashboard' %}"
                class="flex items-center gap-2 text-slate-500 font-bold hover:text-slate-800 transition-colors">
                <i class="bi bi-arrow-left"></i> Retour au tableau de bord
            </a>
        </div>

    </div>
</div>
{% endblock %}
